namespace = demand_admin_override

demand_admin_override.0001 = {
	type = letter_event
	opening = ep3_interactions_events.0005.opening
	desc = {
		desc = ep3_interactions_events.0005.desc
		first_valid = {
			triggered_desc = {
				trigger = { scope:hereditary = yes }
				desc = ep3_interactions_events.0005.hereditary
			}
			desc = ep3_interactions_events.0005.fallback
		}
	}
	sender = scope:actor
	
	trigger = {
		exists = scope:demanded_administration
		scope:recipient.primary_title = scope:demanded_administration
		scope:recipient = { target_is_liege_or_above = scope:actor }
	}
	
	#Accept
	option = {
		name = ep3_interactions_events.0005.a
		scope:actor = {
			send_interface_toast = {
				type = event_toast_effect_good
				title = demand_admin_interaction_accept
				left_icon = scope:recipient
				change_to_administrative_interaction_effect = yes
			}
		}
		stress_impact = {
			greedy = medium_stress_impact_gain
		}
		ai_chance = {
			base = 0
			demand_admin_acceptance_modifier = yes
		}
	}
	
	#Favor
	option = {
		name = ep3_interactions_events.0005.b
		trigger = {
			NOT = {
				has_hook_of_type = {
					target = scope:actor
					type = favor_hook
				}
			}
			scope:hook = no
		}
		show_as_unavailable = { scope:hook = yes }
		custom_description_no_bullet = {
			text = if_actor_accepts_desc
			object = scope:actor
		}
		show_as_tooltip = {
			add_hook = {
				target = scope:actor
				type = favor_hook
			}
			change_to_administrative_interaction_effect = yes
		}
		scope:actor = {
			trigger_event = {
				id = ep3_interactions_events.0001
				days = 5
			}
		}
		ai_chance = {
			base = 0
			demand_admin_acceptance_modifier = yes
			modifier = {
				factor = 0.25
			}
			modifier = {
				this.liege = scope:actor
				is_powerful_vassal_of = scope:actor
				factor = 10
			}
			modifier = {
				has_trait = ambitious
				factor = 10
			}
			modifier = {
				has_trait = trusting
				factor = 0
			}
		}
	}
	
	#Gold
	option = {
		name = ep3_interactions_events.0005.c
		trigger = { scope:hook = no }
		show_as_unavailable = { scope:hook = yes }
		save_scope_value_as = {
			name = gold
			value = yes
		}
		custom_description_no_bullet = {
			text = if_actor_accepts_desc
			object = scope:actor
		}
		show_as_tooltip = {
			change_to_administrative_interaction_effect = yes
		}
		scope:actor = {
			trigger_event = {
				id = ep3_interactions_events.0002
				days = 5
			}
		}
		ai_chance = {
			base = 0
			demand_admin_acceptance_modifier = yes
			modifier = {
				factor = 0.25
			}
			modifier = {
				has_trait = greedy
				factor = 10
			}
		}
	}
	
	#Refuse
	option = {
		name = ep3_interactions_events.0005.d
		trigger = { scope:hook = no }
		show_as_unavailable = { scope:hook = yes }
		scope:actor = {
			send_interface_toast = {
				type = event_toast_effect_bad
				title = demand_admin_interaction_refuse
				left_icon = scope:recipient
				custom_tooltip = demand_admin_interaction_vassal_refuses
			}
			if = {
				limit = { is_ai = yes }
				add_opinion = {
					modifier = angry_opinion
					target = scope:recipient
					opinion = -15
				}
			}
		}
		ai_chance = {
			base = 0
			demand_admin_acceptance_modifier = yes
			modifier = {
				factor = -1
			}
		}
	}
}