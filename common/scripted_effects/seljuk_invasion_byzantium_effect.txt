spawn_seljuk_invasion_byzantium_character_effect = {
	if = {
		limit = {
			exists = title:e_persia.holder
		}
		title:e_persia.holder = {
			culture = { save_scope_as = seljuk_birth_culture }
			faith = { save_scope_as = seljuk_birth_faith }
			house = { save_scope_as = seljuk_birth_house }
		}
	}
	else = {
		culture:turkish = { save_scope_as = seljuk_birth_culture }
		faith:maturidi = { save_scope_as = seljuk_birth_faith }
		house:house_seljuk = { save_scope_as = seljuk_birth_house }
	}
	
	if = {
		limit = {
			has_game_rule = invader_turkmen_culture
		}
		culture:turkmen = { save_scope_as = seljuk_birth_culture }
	}
	
	title:c_edessa = { save_scope_as = seljuk_birthplace }
	
	create_character = {
		age = { 20 30 }
		location = scope:seljuk_birthplace
		gender_female_chance = fp3_chance_female_leader
		culture = scope:seljuk_birth_culture
		faith = scope:seljuk_birth_faith
		trait = brave
		trait = ambitious
		trait = impatient
		trait = education_martial_4
		trait = rough_terrain_expert
		trait = warlike_court_2
		martial = { 16 21 }
		stewardship = { 8 11 }
		diplomacy = { 12 14 }
		intrigue = { 6 9 }
		learning = { 9 11 }
		prowess	 = { 20 24 }
		
		dynasty_house = scope:seljuk_birth_house
		
		after_creation = {
			add_gold =  { medium_gold_min_value major_gold_max_value }
			add_prestige = { medium_prestige_value massive_prestige_value }
			add_piety = { medium_piety_value massive_piety_value }
			add_martial_lifestyle_xp = 10000
			add_trait = strong
			add_character_flag = is_seljuk
			give_seljuk_invasion_byzantium_title_effect = yes
			game_rule_create_spouse_and_children = { CHARACTER = this }
		}
		save_scope_as = seljuk_byzantium_invader
	}
}


## Set up default title
give_seljuk_invasion_byzantium_title_effect = {
	create_dynamic_title = {
		tier = duchy
		name = seljuk_invaders_temp_title_name
		adj = fp3_seljuk_horde_title_adj
	}
	create_title_and_vassal_change = {
		type = created
		save_scope_as = change
		add_claim_on_loss = no
	}
	
	scope:new_title = {
		set_capital_county = scope:seljuk_birthplace.county
		set_landless_title = yes
		set_coa = scope:seljuk_byzantium_invader.house
		set_destroy_if_invalid_heir = yes
		set_destroy_on_gain_same_tier = yes
		set_delete_on_destroy = yes
		set_no_automatic_claims = yes
		set_definitive_form = yes
		set_can_be_named_after_dynasty = no
		set_can_use_nomadic_naming = no
		change_title_holder = {
			holder = scope:seljuk_byzantium_invader
			change = scope:change
		}
	}
	resolve_title_and_vassal_change = scope:change
}

spawn_seljuk_invasion_byzantium_troops = {
	spawn_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
	spawn_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
	spawn_temp_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
	spawn_temp_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
	spawn_temp_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
	spawn_temp_nomadic_troops = {
		LOCATION = scope:seljuk_byzantium_invader.location
	}
}

# troops will persist after the war but won't be inherited
spawn_nomadic_troops = {
	spawn_army = {
		name = turkmen_nomads
		men_at_arms = {
			type = steppe_raiders
			stacks = 5
		}
		men_at_arms = {
			type = horse_archers
			stacks = 5
		}
		men_at_arms = {
			type = cataphract_archers
			stacks = 2
		}
		men_at_arms = {
			type = mangonel
			stacks = 4
		}
		location = $LOCATION$
		inheritable = no
		uses_supply = no
	}
}

# troops will disband after the war
spawn_temp_nomadic_troops = {
	spawn_army = {
		name = turkmen_nomads
		men_at_arms = {
			type = steppe_raiders
			stacks = 4
		}
		men_at_arms = {
			type = horse_archers
			stacks = 4
		}
		men_at_arms = {
			type = cataphract_archers
			stacks = 4
		}
		location = $LOCATION$
		war = scope:seljuk_byzantium_invasion_war
		uses_supply = no
	}
}

seljuk_invader_spread_culture_effect = {
	culture = { save_scope_as = new_culture}
	title:c_lycaonia = { set_county_culture = scope:new_culture }
	title:c_galatia_salutaris = { set_county_culture = scope:new_culture }
	title:c_cappadocia = { set_county_culture = scope:new_culture }
	title:c_lower_galatia = { set_county_culture = scope:new_culture }
	title:c_kyzistra = { set_county_culture = scope:new_culture }
	title:c_isauria = { set_county_culture = scope:new_culture }
}

seljuk_invader_county_modifier_effect = {
	every_sub_realm_county = {
		add_county_modifier = {
			modifier = seljuk_invader_modifier
			years = 15
		}
	}
}

fix_rum_anatolia_kingdom_capital_effect = {
	title:k_rum = {
		set_capital_county = title:c_lycaonia
	}
	title:k_anatolia = {
		set_capital_county = title:c_lycia
	}
}